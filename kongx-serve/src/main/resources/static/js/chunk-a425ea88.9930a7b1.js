(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a425ea88"],{"442f":function(e,t,l){"use strict";l.r(t);var n=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",[l("basic-container",[l("el-alert",{attrs:{title:"设置环境及激活",type:"info","show-icon":""}},[e._v("设置系统环境相关配置,请点击：\n      "),e.permission.manage_env?l("router-link",{attrs:{to:"/operating/envs"}},[l("strong",[l("el-link",{attrs:{type:"success",underline:!1}},[e._v("环境管理")])],1)]):e._e(),e._v("，或联系管理员")],1),l("avue-crud",{ref:"crud",attrs:{option:e.tableOption,data:e.tableData,"table-loading":e.tableLoading},on:{"refresh-change":e.handlerefreshChange},scopedSlots:e._u([{key:"id",fn:function(t){var n=t.row;return[e.activeClient.id!=n.id?l("el-button",{attrs:{type:"info",size:"mini",plain:""},on:{click:function(t){return e.handActiveClient(n)}}},[e._v("激活")]):e._e(),e.activeClient.id==n.id?l("el-button",{attrs:{type:"success",size:"mini"}},[e._v("已激活")]):e._e()]}},{key:"menuLeft",fn:function(t){return[(e.permission.client_add,e._e())]}},{key:"menu",fn:function(t){return[e.permission.client_update?l("el-button",{attrs:{icon:"el-icon-edit",size:"small",type:"primary",plain:""},on:{click:function(l){return e.toEditClient(t.row,t.$index)}}},[e._v("编辑")]):e._e(),e.permission.client_delete?l("el-button",{attrs:{icon:"el-icon-delete",size:"small",type:"danger",plain:""},on:{click:function(l){return e.handlerDelete(t.row,t.$index)}}},[e._v("删除")]):e._e()]}}])})],1),e.grade.box?l("el-dialog",{attrs:{title:"新增Kong连接",width:"70%",visible:e.grade.box},on:{"update:visible":function(t){return e.$set(e.grade,"box",t)}}},[l("avue-form",{attrs:{option:e.clientColumn},on:{submit:e.handleClient},model:{value:e.clientForm,callback:function(t){e.clientForm=t},expression:"clientForm"}})],1):e._e()],1)},a=[],i=l("5176"),r=l.n(i),o=(l("7f7f"),l("cebc")),s=l("5880"),c=l("af62"),d=l("5640"),u={name:"client",components:{},data:function(){return{tableOption:d["b"],clientColumn:d["a"],tableData:[],tableLoading:!1,clientForm:{},activeClient:{id:-1},grade:{box:!1}}},created:function(){this.findActiveKongclient(),this.handleList(),this.initOptions(),this.$notify({title:"提示",type:"warning",message:"请激活当前使用环境！！！",offset:100})},watch:{},mounted:function(){},computed:Object(o["a"])({},Object(s["mapGetters"])(["permission","userInfo"])),props:[],methods:{initOptions:function(){this.tableOption["menu"]=!1},findActiveKongclient:function(){var e=this;this.$store.dispatch("FindActiveClient",this.userInfo).then(function(t){e.activeClient=t})},handActiveClient:function(e){var t=this;Object(c["i"])(this.userInfo.name,e).then(function(e){window.location.href.indexOf("#/wel/index")>0?window.location.reload():t.$nextTick(function(e){t.$router.push("/wel/index")})})},toEditClient:function(e,t){this.grade.box=!0,this.clientForm=e},handlerefreshChange:function(e){this.handleList(this.tableSearch)},handleList:function(e){var t=this;this.tableLoading=!0,Object(c["c"])(r()({})).then(function(e){var l=e.data.data;t.tableData=l,t.tableLoading=!1})},handleClient:function(e,t){var l=this;this.clientForm&&this.clientForm.id?Object(c["j"])(this.clientForm).then(function(e){var n=e.data;0==n.status?(l.$successInfo("修改成功"),l.handleList(),l.grade.box=!1):l.$errorInfo("修改失败"),t()}):Object(c["a"])(this.clientForm).then(function(e){var n=e.data;0==n.status?(l.$successInfo("新增成功"),l.handleList(),l.grade.box=!1):l.$errorInfo("新增失败"),t()})},handlerDelete:function(e){var t=this;this.$confirm("是否确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(c["h"])(e).then(function(e){var l=e.data;0==l.status?(t.$successInfo("删除成功"),t.handleList()):t.$errorInfo("删除失败")})})}}},p=u,b=(l("4c65"),l("2877")),m=Object(b["a"])(p,n,a,!1,null,"2f514c64",null);t["default"]=m.exports},"4c65":function(e,t,l){"use strict";var n=l("fa68"),a=l.n(n);a.a},5640:function(e,t,l){"use strict";l.d(t,"e",function(){return r}),l.d(t,"a",function(){return o}),l.d(t,"b",function(){return s}),l.d(t,"h",function(){return c}),l.d(t,"f",function(){return d}),l.d(t,"c",function(){return u}),l.d(t,"d",function(){return p}),l.d(t,"i",function(){return b}),l.d(t,"g",function(){return m});var n,a=l("bd86"),i=(l("e349"),l("c54a"),l("074d")),r={card:!0,size:"small",emptyBtn:!1,group:[{label:"网关配置",column:[{label:"Kong Admin URL",row:!0,span:24,labelWidth:140,value:"http://localhost:8001/",prop:"url",tip:"请填写kong的管理URL，如：http://localhost:8001/",rules:[{required:!0,message:"请填写URL，如：http://localhost:8001/",trigger:"blur"}]}]},{label:"环境信息",column:[{label:"名称",prop:"name",span:24,labelWidth:140,width:150,rules:[{required:!0,message:"请填写名称",trigger:"blur"}]},{label:"环境编码",prop:"profileCode",span:24,labelWidth:140,width:150,rules:[{required:!0,message:"请填写环境编码",trigger:"blur"}]},{label:"所属环境",prop:"env",span:24,labelWidth:140,width:150,disabled:!0},{label:"部署类型",prop:"deployType",span:24,labelWidth:140,width:150,disabled:!0},{label:"简称",prop:"ab",span:24,labelWidth:140,width:150,disabled:!0}]}]},o={column:[{label:"名称",prop:"name",span:24,labelWidth:140,width:150,rules:[{required:!0,message:"请填写名称",trigger:"blur"}]},{label:"Kong Admin URL",row:!0,span:24,labelWidth:140,prop:"url",tip:"请填写kong的管理URL，如：http://localhost:8001/",rules:[{required:!0,message:"请填写URL，如：http://localhost:8001/",trigger:"blur"}]},{label:"所属环境",labelWidth:140,prop:"profile",type:"select",group:!0,dicUrl:i["a"].path+"/system/envs/"}]},s=(n={maxHeight:600,labelWidth:120,simplePage:!0,index:!0,border:!0,menuBtn:!0,addBtn:!1},Object(a["a"])(n,"simplePage",!0),Object(a["a"])(n,"delBtn",!1),Object(a["a"])(n,"editBtn",!1),Object(a["a"])(n,"refreshBtn",!1),Object(a["a"])(n,"columnBtn",!1),Object(a["a"])(n,"menuAlign","center"),Object(a["a"])(n,"align","center"),Object(a["a"])(n,"searchSize","mini"),Object(a["a"])(n,"column",[{label:"Active",prop:"id",slot:!0,width:80},{label:"Name",prop:"name",sortable:!0,width:150},{label:"Kong Admin URL",prop:"url"},{label:"Version",prop:"version"},{label:"Created_at",prop:"create_at",width:"180",sortable:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",formatter:function(e,t,l,n){return t}}]),n),c={maxHeight:900,expand:!0,labelWidth:120,index:!0,menuBtn:!0,addBtn:!1,delBtn:!1,editBtn:!1,simplePage:!0,refreshBtn:!1,columnBtn:!1,menuAlign:"center",align:"center",searchSize:"mini",menu:!1,column:[{label:"源环境",prop:"src_client",slot:!0,width:"280"},{label:"目标环境",prop:"clients",overHidden:!0,slot:!0},{label:"数据类型",prop:"dataType"},{label:"同步策略",prop:"policy"},{label:"同步时间",prop:"create_at",width:"180",sortable:!0,type:"datetime",slot:!0},{label:"同步状态",prop:"status"},{label:"备注",span:24,labelWidth:140,overHidden:!0,type:"textarea",prop:"comment"},{label:"操作人",prop:"creator",width:100}]},d={maxHeight:600,labelWidth:120,menuBtn:!0,addBtn:!1,delBtn:!1,viewBtn:!0,editBtn:!1,menuAlign:"center",align:"center",menu:!1,columnBtn:!1,refreshBtn:!1,column:[{label:"同步时间",prop:"create_at",width:"160",sortable:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",formatter:function(e,t,l,n){return t}},{label:"同步消息",prop:"comment",align:"left",width:400}]},u={column:[{label:"KEY",prop:"configKey",span:24,labelWidth:140,width:150,rules:[{required:!0,message:"请填写key",trigger:"blur"}]},{label:"VALUE",row:!0,span:24,labelWidth:140,type:"textarea",prop:"configValue",rules:[{required:!0,message:"请填写key值",trigger:"blur"}]},{label:"参数类型",row:!0,span:24,labelWidth:140,type:"select",prop:"configType",dicUrl:i["a"].path+"/system/envs/configTypes",rules:[{required:!0,message:"请选择参数类型",trigger:"blur"}]},{label:"备注",span:24,labelWidth:140,type:"textarea",prop:"comment"}]},p={maxHeight:600,expand:!0,labelWidth:120,simplePage:!0,index:!0,menuBtn:!0,stripe:!0,addBtn:!1,delBtn:!1,editBtn:!1,menuAlign:"center",align:"center",searchSize:"mini",column:[{label:"KEY",prop:"configKey",align:"left",width:240},{label:"VALUE",prop:"configValue",overHidden:!0},{label:"备注",width:240,prop:"comment"},{label:"创建日期",prop:"create_at",width:"180",sortable:!0,type:"datetime",slot:!0}]},b={card:!0,group:[{icon:"el-icon-info",label:"同步配置信息",column:[{label:"源环境",type:"select",labelWidth:150,span:24,formslot:!0,prop:"src_client"},{label:"目标环境",prop:"clients",labelWidth:150,formslot:!0},{label:"待同步的服务列表",prop:"services",span:24,labelWidth:150,formslot:!0}]},{label:"同步信息",column:[]}]},m={maxHeight:600,labelWidth:120,index:!0,menuBtn:!1,addBtn:!1,delBtn:!1,editBtn:!1,stripe:!0,menu:!1,simplePage:!0,refreshBtn:!1,columnBtn:!1,menuAlign:"center",align:"center",searchSize:"mini",column:[{label:"操作时间",prop:"create_at",width:"180",sortable:!0,slot:!0,type:"datetime",format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss",formatter:function(e,t,l,n){return t}},{label:"操作者",prop:"creator",width:100},{label:"操作记录",prop:"remark",align:"left"},{label:"操作环境",prop:"profile",width:100},{label:"执行操作",prop:"operation",width:150,type:"select",dicData:[{label:"登录",value:"login"},{label:"登出",value:"logout"},{label:"同步",value:"sync"},{label:"新增",value:"add"},{label:"修改",value:"update"},{label:"删除",value:"delete"},{label:"执行降级",value:"demote_config"},{label:"降级回滚",value:"rollback_config"},{label:"Arthas调试",value:"arthas_attach"},{label:"启动",value:"job_startup"},{label:"暂停",value:"job_pause"}]},{label:"操作对象",prop:"target",width:150,dicData:[{label:"全局插件",value:"global_plugin"},{label:"路由插件",value:"route_plugin"},{label:"服务插件",value:"service_plugin"},{label:"路由",value:"route"},{label:"服务",value:"service"},{label:"上游服务",value:"upstream"},{label:"上游代理",value:"targets"},{label:"系统",value:"system"},{label:"作业",value:"monitor_job"},{label:"作业任务",value:"monitor_job_task"},{label:"网关服务",value:"sync_service"},{label:"系统参数",value:"server_config"},{label:"系统环境",value:"system_profile"},{label:"降级参数",value:"demote_app_params"},{label:"热配参数",value:"sync_app_params"},{label:"服务进程",value:"service_progress"}]}]}},fa68:function(e,t,l){}}]);